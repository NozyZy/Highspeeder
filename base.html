<!DOCTYPE html>
<html lang="fr">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <title>Highspeeder</title>
    <link href="index.css" rel="stylesheet">
    <link href="base.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">
</head>
<body onload="son(); afficherjeu();">
    <header>
        <a href="index.html" class="logo"><img src="logo.png" alt="logo"></a>
        <nav class="menu">
            <a href="base.html" class="navigation">Accueil</a>
            <a href="jeux.html" class="navigation">Jeux</a>
            <a href="suggestions.html" class="navigation">Suggestions</a>
            <a href="A_propos.html" class="navigation">A propos</a>
        </nav>
        <div class="search">
            <i class="fa fa-search" aria-hidden="true"></i>
            <label for="searchbar">
                <input id="searchbar" type="text" placeholder="Rechercher">
            </label>
        </div>
    </header>
    <span id="top"></span>
    <main>
        <div class="titres">
            <div id="grandtitre"><img src="logo.png" alt="logo"></div>
            <h2 id="petittitre">Quand passion,vitesse et talent ne font plus qu'un ... alors parce que oui en fait et puis aprs tralala la dirladada et parce que ensuite voila</h2>
        </div>
        <div class="games">
            <div class="box">
                <h3>Le jeu du moment</h3>
                <div class="game" id="jeu_du_moment" onclick="locationURL()"></div>
            </div>
            <div class="box">
                <h3>Le dernier jeu</h3>
                <div class="game" id="dernier_jeu_add" onclick="locationURL()"></div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <nav class="menu">
                <a href="A_propos.html">A propos</a>
                <a href="#top">Haut de page</a>
            </nav>
            <audio id="musique" src="test.mp3" loop ></audio>
            <h6>Made with &#128153; by Quentin and Maxime</h6>
        </div>
    </footer>
</body>
<script src="Highspeeder.js" charset="utf-8"></script>
<script type="text/javascript">

    function locationURL() { location.href = 'jeux.html'; }

    function son() {
        let monElementAudio = document.getElementById('musique');
        monElementAudio.volume = 0.01;
        monElementAudio.play();
    }

    function lastGame() {
        const taille = games.length-1
        const grid = document.querySelector('#dernier_jeu_add');

        while(grid.firstChild) {
            grid.removeChild(grid.firstChild);
        }
            const g = games[taille];
            const newImageDiv = document.createElement('div');
            const newTextDiv = document.createElement('div');
            const newTitleDiv = document.createElement('h3');

            newTitleDiv.textContent = g.name;
            newTitleDiv.className = "titre-jeu";
            newTextDiv.append(newTitleDiv);
            newTextDiv.className = "text-jeu";
            newImageDiv.append(newTextDiv);
            newImageDiv.className = "image-jeu";
            newImageDiv.style.backgroundImage = "url('" + g.image + "')"
            grid.appendChild(newImageDiv);
        }

    function top_tendeance() {
        let bestscore = 0;
        let index = 0;
        let score = 0;

        for(let i = 0 ; i < games.length; i++) {
            score = 0;
            for(let o=0; o < games[i].niveaux.length;o++) {
                for(let j=0; j < games[i].niveaux[o].highscore.length; j++) {
                    score = score + 1;
                }
            }
            for(let o=0; o < games[i].niveaux.length;o++){
                for (let y=0; y < games[i].niveaux[o].speedrun.length; y++) {
                    score = score + 1;
                }
            }

            if (score > bestscore) {
                bestscore = score;
                index = i;
            }
        }
        return index;
    }

    function TendeanceGame() {
        var taille = top_tendeance();
        const grid = document.querySelector('#jeu_du_moment');

        while(grid.firstChild) {
            grid.removeChild(grid.firstChild);
        }
        const g = games[taille];
        const newImageDiv = document.createElement('div');
        const newTextDiv = document.createElement('div');
        const newTitleDiv = document.createElement('h3');

        newTitleDiv.textContent = g.name;
        newTitleDiv.className = "titre-jeu";
        newTextDiv.append(newTitleDiv);
        newTextDiv.className = "text-jeu";
        newImageDiv.append(newTextDiv);
        newImageDiv.className = "image-jeu";
        newImageDiv.style.backgroundImage = "url('" + g.image + "')"
        grid.appendChild(newImageDiv);
    }

    function afficherjeu() {
        TendeanceGame();
        lastGame();
    }

</script>



</html>